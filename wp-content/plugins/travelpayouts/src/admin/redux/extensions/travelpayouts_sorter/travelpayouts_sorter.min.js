!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.travelpayouts_sorter=redux.field_objects.travelpayouts_sorter||{};var r="";e(document).ready(function(){});var i=function(e){var r;return e=e||window.event,r=redux.optName.args.save_pending,e&&(e.returnValue=r),window.onbeforeunload=null,r};redux.field_objects.travelpayouts_sorter.init=function(t){t||(t=e(document).find(".redux-group-tab:visible").find(".redux-container-travelpayouts_sorter:visible")),e(t).each(function(){var t=e(this),s=t;t.hasClass("redux-field-container")||(s=t.parents(".redux-field-container:first")),s.is(":hidden")||s.hasClass("redux-field-init")&&(s.removeClass("redux-field-init"),t.find(".redux-sorter").each(function(){var s=e(this).attr("id");t.find("#"+s).find("ul").sortable({items:"li",placeholder:"placeholder",connectWith:".sortlist_"+s,opacity:.8,scroll:!1,out:function(i,t){t.helper&&(r=t.offset.top>0?"down":"up",redux.field_objects.travelpayouts_sorter.scrolling(e(this).parents(".redux-field-container:first")))},over:function(e,i){r=""},deactivate:function(e,i){r=""},stop:function(r,i){var t=redux.travelpayouts_sorter[e(this).attr("data-id")],s=e(this).find("h3").text();t.limits&&s&&t.limits[s]&&(e(this).children("li").length>=t.limits[s]?(e(this).addClass("filled"),e(this).children("li").length>t.limits[s]&&e(i.sender).sortable("cancel")):e(this).removeClass("filled"))},update:function(r,t){var s=redux.travelpayouts_sorter[e(this).attr("data-id")],n=e(this).find("h3").text();s.limits&&n&&s.limits[n]&&(e(this).children("li").length>=s.limits[n]?(e(this).addClass("filled"),e(this).children("li").length>s.limits[n]&&e(t.sender).sortable("cancel")):e(this).removeClass("filled")),e(this).find(".position").each(function(){var r=e(this).parent().attr("data-id"),t=e(this).parent().parent().attr("data-group-id");!function(e){var r,t,s,n,d,a,l,o,u,f;r=jQuery,e=r(e),t=r(e).parents(".redux-container:first"),redux.customizer?r(".redux-customizer-opt-name").data("opt-name"):r.redux.getOptName(t),r("body").trigger("check_dependencies",e),e.hasClass("compiler")&&r("#redux-compiler-hook").val(1),n=(n=(s=r(e).closest(".redux-group-tab").attr("id")).split("_"))[0],d=t.find('.redux-group-tab-link-a[data-key="'+n+'"]').parents(".redux-group-tab-link-li:first"),a=r("#"+s+"_li").parents(".hasSubSections:first"),r(e).parents("fieldset.redux-field:first").hasClass("redux-field-error")&&(r(e).parents("fieldset.redux-field:first").removeClass("redux-field-error"),r(e).parent().find(".redux-th-error").slideUp(),(l=parseInt(t.find(".redux-field-errors span").text(),0)-1)<=0?(r("#"+s+"_li .redux-menu-error").fadeOut("fast").remove(),r("#"+s+"_li .redux-group-tab-link-a").removeClass("hasError"),r("#"+s+"_li").parents(".inside:first").find(".redux-field-errors").slideUp(),r(e).parents(".redux-container:first").find(".redux-field-errors").slideUp(),r("#redux_metaboxes_errors").slideUp()):((o=parseInt(d.find(".redux-menu-error:first").text(),0)-1)<=0?d.find(".redux-menu-error:first").fadeOut().remove():d.find(".redux-menu-error:first").text(o),t.find(".redux-field-errors span").text(l)),0!==a.length&&0===a.find(".redux-menu-error").length&&a.find(".hasError").removeClass("hasError")),r(e).parents("fieldset.redux-field:first").hasClass("redux-field-warning")&&(r(e).parents("fieldset.redux-field:first").removeClass("redux-field-warning"),r(e).parent().find(".redux-th-warning").slideUp(),(u=parseInt(t.find(".redux-field-warnings span").text(),0)-1)<=0?(r("#"+s+"_li .redux-menu-warning").fadeOut("fast").remove(),r("#"+s+"_li .redux-group-tab-link-a").removeClass("hasWarning"),r("#"+s+"_li").parents(".inside:first").find(".redux-field-warnings").slideUp(),r(e).parents(".redux-container:first").find(".redux-field-warnings").slideUp(),r("#redux_metaboxes_warnings").slideUp()):((f=parseInt(d.find(".redux-menu-warning:first").text(),0)-1)<=0?d.find(".redux-menu-warning:first").fadeOut().remove():d.find(".redux-menu-warning:first").text(f),t.find(".redux-field-warning span").text(u)),0!==a.length&&0===a.find(".redux-menu-warning").length&&a.find(".hasWarning").removeClass("hasWarning")),t.find(".saved_notice:visible").length>0||redux.optName.args.disable_save_warn||(t.find(".redux-save-warn").slideDown(),window.onbeforeunload=i)}(e(this));var s=e(this).parent().parent().parent().attr("id");e(this).prop("name",redux.args.opt_name+"["+s+"]["+t+"]["+r+"]")})}}),t.find(".redux-sorter").disableSelection()}))})},redux.field_objects.travelpayouts_sorter.scrolling=function(e){if(void 0!==e){var i=e.find(".redux-sorter");"up"==r?(i.scrollTop(i.scrollTop()-20),setTimeout(redux.field_objects.travelpayouts_sorter.scrolling,50)):"down"==r&&(i.scrollTop(i.scrollTop()+20),setTimeout(redux.field_objects.travelpayouts_sorter.scrolling,50))}}}(jQuery);